import pandas as pd import time def clean(df): for col in df.columns: try: df[col] = pd.to_numeric(df[col]) except Exception: pass return df def process_list_files(path_in, path_out , chunksize=10000): start = time.time() files = True rows=0 for chunk in pd.read_csv(path_in, chunksize=chunksize): chunk = clean(chunk) chunk.to_csv(path_out, mode='w' if files else 'a', index=False ,header=False) rows += len(chunk) files = False end = time.time() print("rows=", rows) print("time:", end - start) process_list_files(r'C:\Users\Administrator\Downloads\day13_large_users.csv', r"C:\Users\Administrator\Downloads\day13_cleaned.csv")